<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>准备 | 虚心若愚 求知若渴</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/hellof/static/pictures/eagle.png">
    <meta name="description" content=" ">
    
    <link rel="preload" href="/hellof/assets/css/0.styles.b122a951.css" as="style"><link rel="preload" href="/hellof/assets/js/app.eec69b23.js" as="script"><link rel="preload" href="/hellof/assets/js/2.c60f8f4a.js" as="script"><link rel="preload" href="/hellof/assets/js/34.be2de1e0.js" as="script"><link rel="prefetch" href="/hellof/assets/js/10.a1481cda.js"><link rel="prefetch" href="/hellof/assets/js/11.09b76f98.js"><link rel="prefetch" href="/hellof/assets/js/12.9ef86b12.js"><link rel="prefetch" href="/hellof/assets/js/13.d3bdee46.js"><link rel="prefetch" href="/hellof/assets/js/14.56817cd5.js"><link rel="prefetch" href="/hellof/assets/js/15.81c2dad4.js"><link rel="prefetch" href="/hellof/assets/js/16.37e76fb1.js"><link rel="prefetch" href="/hellof/assets/js/17.8eae35c3.js"><link rel="prefetch" href="/hellof/assets/js/18.bdcf906e.js"><link rel="prefetch" href="/hellof/assets/js/19.773e2eb1.js"><link rel="prefetch" href="/hellof/assets/js/20.7e67cfb5.js"><link rel="prefetch" href="/hellof/assets/js/21.12b4c26d.js"><link rel="prefetch" href="/hellof/assets/js/22.b5a96ea5.js"><link rel="prefetch" href="/hellof/assets/js/23.460b33d0.js"><link rel="prefetch" href="/hellof/assets/js/24.c068723f.js"><link rel="prefetch" href="/hellof/assets/js/25.dca7bcad.js"><link rel="prefetch" href="/hellof/assets/js/26.1cd9100c.js"><link rel="prefetch" href="/hellof/assets/js/27.24c7a00c.js"><link rel="prefetch" href="/hellof/assets/js/28.54e4a3a1.js"><link rel="prefetch" href="/hellof/assets/js/29.03c5ba53.js"><link rel="prefetch" href="/hellof/assets/js/3.3b82c263.js"><link rel="prefetch" href="/hellof/assets/js/30.1ca93aa1.js"><link rel="prefetch" href="/hellof/assets/js/31.cb09bb4e.js"><link rel="prefetch" href="/hellof/assets/js/32.46d80373.js"><link rel="prefetch" href="/hellof/assets/js/33.3274a1e5.js"><link rel="prefetch" href="/hellof/assets/js/35.319c95b7.js"><link rel="prefetch" href="/hellof/assets/js/36.369d3f4f.js"><link rel="prefetch" href="/hellof/assets/js/37.4cc51429.js"><link rel="prefetch" href="/hellof/assets/js/38.8556de39.js"><link rel="prefetch" href="/hellof/assets/js/39.03fdf0b0.js"><link rel="prefetch" href="/hellof/assets/js/4.109dc044.js"><link rel="prefetch" href="/hellof/assets/js/40.680f208c.js"><link rel="prefetch" href="/hellof/assets/js/41.fdb3b944.js"><link rel="prefetch" href="/hellof/assets/js/42.f8fa06a5.js"><link rel="prefetch" href="/hellof/assets/js/43.6db2e8b5.js"><link rel="prefetch" href="/hellof/assets/js/44.da84cdf4.js"><link rel="prefetch" href="/hellof/assets/js/45.ef1b717c.js"><link rel="prefetch" href="/hellof/assets/js/46.8aecdd72.js"><link rel="prefetch" href="/hellof/assets/js/47.99ad28b4.js"><link rel="prefetch" href="/hellof/assets/js/48.b7b1f966.js"><link rel="prefetch" href="/hellof/assets/js/49.210936eb.js"><link rel="prefetch" href="/hellof/assets/js/5.ef5ba397.js"><link rel="prefetch" href="/hellof/assets/js/50.b045318b.js"><link rel="prefetch" href="/hellof/assets/js/51.67a4baa1.js"><link rel="prefetch" href="/hellof/assets/js/52.2e8cb6ef.js"><link rel="prefetch" href="/hellof/assets/js/53.e8cc057c.js"><link rel="prefetch" href="/hellof/assets/js/54.6b521849.js"><link rel="prefetch" href="/hellof/assets/js/55.f3ec65c0.js"><link rel="prefetch" href="/hellof/assets/js/56.db215c70.js"><link rel="prefetch" href="/hellof/assets/js/57.773b5a63.js"><link rel="prefetch" href="/hellof/assets/js/58.e9c5518e.js"><link rel="prefetch" href="/hellof/assets/js/59.24554a3a.js"><link rel="prefetch" href="/hellof/assets/js/6.9ba6c2dc.js"><link rel="prefetch" href="/hellof/assets/js/60.4710b701.js"><link rel="prefetch" href="/hellof/assets/js/61.4ec5c395.js"><link rel="prefetch" href="/hellof/assets/js/62.88e41689.js"><link rel="prefetch" href="/hellof/assets/js/63.35e3df23.js"><link rel="prefetch" href="/hellof/assets/js/64.db96da27.js"><link rel="prefetch" href="/hellof/assets/js/65.ee730c0f.js"><link rel="prefetch" href="/hellof/assets/js/66.456c9fb5.js"><link rel="prefetch" href="/hellof/assets/js/67.3b18aa86.js"><link rel="prefetch" href="/hellof/assets/js/68.faeed2d4.js"><link rel="prefetch" href="/hellof/assets/js/69.f75b9eb8.js"><link rel="prefetch" href="/hellof/assets/js/7.81d99531.js"><link rel="prefetch" href="/hellof/assets/js/70.bfabcba1.js"><link rel="prefetch" href="/hellof/assets/js/71.f4a6a6a4.js"><link rel="prefetch" href="/hellof/assets/js/72.b0d76d67.js"><link rel="prefetch" href="/hellof/assets/js/73.3e555f49.js"><link rel="prefetch" href="/hellof/assets/js/74.ade6438a.js"><link rel="prefetch" href="/hellof/assets/js/75.7603458d.js"><link rel="prefetch" href="/hellof/assets/js/8.cf9c7f28.js"><link rel="prefetch" href="/hellof/assets/js/9.f79ac362.js">
    <link rel="stylesheet" href="/hellof/assets/css/0.styles.b122a951.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hellof/" class="home-link router-link-active"><!----> <span class="site-name">虚心若愚 求知若渴</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hellof/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/hellof/java/class.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  JAVA
</a></div><div class="nav-item"><a href="/hellof/frontEnd/css/selector.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/hellof/db/mysql/executionPlan.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><a href="/hellof/linux/fileDirMg.html" class="nav-link">
  LINUX
</a></div><div class="nav-item"><a href="/hellof/python.html" class="nav-link">
  PYTHON
</a></div><div class="nav-item"><a href="/hellof/openFrame/others.html" class="nav-link">
  开源框架
</a></div><div class="nav-item"><a href="/hellof/tools/giteeVuePress.html" class="nav-link">
  工具
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hellof/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/hellof/java/class.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  JAVA
</a></div><div class="nav-item"><a href="/hellof/frontEnd/css/selector.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/hellof/db/mysql/executionPlan.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><a href="/hellof/linux/fileDirMg.html" class="nav-link">
  LINUX
</a></div><div class="nav-item"><a href="/hellof/python.html" class="nav-link">
  PYTHON
</a></div><div class="nav-item"><a href="/hellof/openFrame/others.html" class="nav-link">
  开源框架
</a></div><div class="nav-item"><a href="/hellof/tools/giteeVuePress.html" class="nav-link">
  工具
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/hellof/java/class.html" aria-current="page" class="active sidebar-link">字节码文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/java/class.html#准备" class="sidebar-link">准备</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/java/class.html#测试类" class="sidebar-link">测试类</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#字节码" class="sidebar-link">字节码</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#其指令集" class="sidebar-link">其指令集</a></li></ul></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#字节码组成" class="sidebar-link">字节码组成</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/java/class.html#常量池计数器和常量池" class="sidebar-link">常量池计数器和常量池</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#access-flags-访问标志" class="sidebar-link">access_flags（访问标志）</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#类索引、超类索引" class="sidebar-link">类索引、超类索引</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#接口计数器、接口表" class="sidebar-link">接口计数器、接口表</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#字段计数器、字段表" class="sidebar-link">字段计数器、字段表</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#方法计数器、方法表" class="sidebar-link">方法计数器、方法表</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#属性计数器、属性表" class="sidebar-link">属性计数器、属性表</a></li><li class="sidebar-sub-header"><a href="/hellof/java/class.html#属性表" class="sidebar-link">属性表</a></li></ul></li></ul></li><li><a href="/hellof/java/load.html" class="sidebar-link">类加载机制</a></li><li><a href="/hellof/java/memory.html" class="sidebar-link">内存分配</a></li><li><a href="/hellof/java/gc.html" class="sidebar-link">垃圾回收</a></li><li><a href="/hellof/java/generic.html" class="sidebar-link">泛型机制</a></li><li><a href="/hellof/java/innerclass.html" class="sidebar-link">内部类</a></li><li><a href="/hellof/java/juc.html" class="sidebar-link">线程</a></li><li><a href="/hellof/java/enum.html" class="sidebar-link">枚举</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="准备">准备</h2> <h3 id="测试类">测试类</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tab<span class="token punctuation">.</span>test_05</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">doSomethind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>片段0-0-0：pojo（Test.java）</p></blockquote> <h3 id="字节码">字节码</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>cafe babe 0000 0034 0019 0a00 0400 1509
0003 0016 0700 1707 0018 0100 046e 616d
6501 0012 4c6a 6176 612f 6c61 6e67 2f53
7472 696e 673b 0100 063c 696e 6974 3e01
0003 2829 5601 0004 436f 6465 0100 0f4c
696e 654e 756d 6265 7254 6162 6c65 0100
124c 6f63 616c 5661 7269 6162 6c65 5461
626c 6501 0004 7468 6973 0100 164c 636f
6d2f 7461 622f 7465 7374 5f30 352f 5465
7374 3b01 0007 6765 744e 616d 6501 0014
2829 4c6a 6176 612f 6c61 6e67 2f53 7472
696e 673b 0100 0773 6574 4e61 6d65 0100
1528 4c6a 6176 612f 6c61 6e67 2f53 7472
696e 673b 2956 0100 0b64 6f53 6f6d 6574
6869 6e67 0100 0a53 6f75 7263 6546 696c
6501 0009 5465 7374 2e6a 6176 610c 0007
0008 0c00 0500 0601 0014 636f 6d2f 7461
622f 7465 7374 5f30 352f 5465 7374 0100
106a 6176 612f 6c61 6e67 2f4f 626a 6563
7400 2100 0300 0400 0000 0100 0200 0500
0600 0000 0400 0100 0700 0800 0100 0900
0000 2f00 0100 0100 0000 052a b700 01b1
0000 0002 000a 0000 0006 0001 0000 0003
000b 0000 000c 0001 0000 0005 000c 000d
0000 0001 000e 000f 0001 0009 0000 002f
0001 0001 0000 0005 2ab4 0002 b000 0000
0200 0a00 0000 0600 0100 0000 0600 0b00
0000 0c00 0100 0000 0500 0c00 0d00 0000
0100 1000 1100 0100 0900 0000 3e00 0200
0200 0000 062a 2bb5 0002 b100 0000 0200
0a00 0000 0a00 0200 0000 0900 0500 0a00
0b00 0000 1600 0200 0000 0600 0c00 0d00
0000 0000 0600 0500 0600 0100 0900 1200
0800 0100 0900 0000 1900 0000 0000 0000
01b1 0000 0001 000a 0000 0006 0001 0000
000b 0001 0013 0000 0002 0014 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><blockquote><p>片段0-0-1：用sublime工具以16进制式查看Test.class</p></blockquote> <h3 id="其指令集">其指令集</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>Classfile /F:/workfile/.../test_05/Test.class
  Last modified 2019-8-2; size 572 bytes
  MD5 checksum 01f2fc791a71a4c22f40e328a182f9a5
  Compiled from &quot;Test.java&quot;
public class com.tab.test_05.Test
  minor version: 0
  major version: 52
  flags: ACC_PUBLIC, ACC_SUPER
Constant pool:
   #1 = Methodref          #4.#21         // java/lang/Object.&quot;&lt;init&gt;&quot;:()V
   #2 = Fieldref           #3.#22         // com/tab/test_05/Test.name:Ljava/lang/String;
   #3 = Class              #23            // com/tab/test_05/Test
   #4 = Class              #24            // java/lang/Object
   #5 = Utf8               name
   #6 = Utf8               Ljava/lang/String;
   #7 = Utf8               &lt;init&gt;
   #8 = Utf8               ()V
   #9 = Utf8               Code
  #10 = Utf8               LineNumberTable
  #11 = Utf8               LocalVariableTable
  #12 = Utf8               this
  #13 = Utf8               Lcom/tab/test_05/Test;
  #14 = Utf8               getName
  #15 = Utf8               ()Ljava/lang/String;
  #16 = Utf8               setName
  #17 = Utf8               (Ljava/lang/String;)V
  #18 = Utf8               doSomething
  #19 = Utf8               SourceFile
  #20 = Utf8               Test.java
  #21 = NameAndType        #7:#8          // &quot;&lt;init&gt;&quot;:()V
  #22 = NameAndType        #5:#6          // name:Ljava/lang/String;
  #23 = Utf8               com/tab/test_05/Test
  #24 = Utf8               java/lang/Object
{
  public com.tab.test_05.Test();
    descriptor: ()V
    flags: ACC_PUBLIC
    Code:
      stack=1, locals=1, args_size=1
         0: aload_0
         1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V
         4: return
      LineNumberTable:
        line 3: 0
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       5     0  this   Lcom/tab/test_05/Test;

  public java.lang.String getName();
    descriptor: ()Ljava/lang/String;
    flags: ACC_PUBLIC
    Code:
      stack=1, locals=1, args_size=1
         0: aload_0
         1: getfield      #2                  // Field name:Ljava/lang/String;
         4: areturn
      LineNumberTable:
        line 6: 0
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       5     0  this   Lcom/tab/test_05/Test;

  public void setName(java.lang.String);
    descriptor: (Ljava/lang/String;)V
    flags: ACC_PUBLIC
    Code:
      stack=2, locals=2, args_size=2
         0: aload_0
         1: aload_1
         2: putfield      #2                  // Field name:Ljava/lang/String;
         5: return
      LineNumberTable:
        line 9: 0
        line 10: 5
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       6     0  this   Lcom/tab/test_05/Test;
            0       6     1  name   Ljava/lang/String;

  public static void doSomething();
    descriptor: ()V
    flags: ACC_PUBLIC, ACC_STATIC
    Code:
      stack=0, locals=0, args_size=0
         0: return
      LineNumberTable:
        line 11: 0
}
SourceFile: &quot;Test.java&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br></div></div><blockquote><p>片段0-0-2：用javap -v Test.class 查看其字节码指令</p></blockquote> <h2 id="字节码组成">字节码组成</h2> <blockquote><p>每一个字节码文件对应着一个ClassFile结构，如下(un表示无符号类型的n个字节)：</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>ClassFile {
    u4 magic; //magic number用于校验字节码文件合法性，oxCAFEBABE
    u2 minor_version;//次版本号 
    u2 major_version; //主版本号 jdk1.8为52
    u2 constant_pool_count; //常量池计数器
    cp_info constant_pool[constant_pool_count-1];//常量池 
    u2 access_flag;//访问标志
    u2 this_class;//当前类索引
    u2 super_class;//父类索引
    u2 interfaces_count;//接口计数器
    u2 interfaces[interfaces_count];//接口表
    u2 fields_count;//字段计数器
    field_info fields[fields_count];//字段表
    u2 methods_count;//方法计数器 
    method_info methods[methods_count];//方法表
    u2 attributes_count;//属性计数器
    attribute_info attributes[attributes_count];//属性表 
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="常量池计数器和常量池">常量池计数器和常量池</h3> <blockquote><p>  常量池主要用于存放字面量和符号引用，访问方式通过索引进行访问，但每个class文件中的常量数是不固定的，所以在常量池之前有一个2字节的计数器，
即0-0-1的第一排第五段，该例为0019，表示常量池中有25-1（计数器从1开始计数的，但是0仍存在，可想象成数组下标0没放东西）个常量，常量池存放的字面量由文字字符串和final常量值等构成，符号引用
包括类和接口的全限定名、字段的名称和描述符以及方法的名称和描述符。常量池中的常量类型如下图0-0-4，在该Test.class中的常量如片段0-0-2的9-32行。</p></blockquote> <div style="width:740px;overflow-x:auto;"><table width="1224" border="0" cellpadding="0" cellspacing="0" style="width:734.40pt;border-collapse:collapse;table-layout:fixed;"><col width="200" style="mso-width-source:userset;mso-width-alt:8893;"> <col width="236" style="mso-width-source:userset;mso-width-alt:6904;"> <col width="98" style="mso-width-source:userset;mso-width-alt:2867;"> <col width="267.00" style="mso-width-source:userset;mso-width-alt:7811;"> <col width="319" style="mso-width-source:userset;mso-width-alt:9332;"> <tr height="24" style="height:14.40pt;"><td height="24" width="304" x:str="" class="xl65" style="height:14.40pt;width:182.40pt;">类型</td> <td width="236" x:str="" class="xl66" style="width:141.60pt;">描述</td> <td width="98" x:str="" class="xl67" style="width:58.80pt;">tag</td> <td width="267.00" x:str="" class="xl67" style="width:160.20pt;">项目-字节长度</td> <td width="319" x:str="" class="xl68" style="width:191.40pt;">项目描述</td></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Utf8_info</td> <td rowspan="2" x:str="" class="xl70" style="border-bottom:none;">UTF-8编码的字符串</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">1</td> <td x:str="" class="xl67">length-2</td> <td x:str="" class="xl68">UTF-8编码的字符串占用字节数</td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl67">bytes-1</td> <td x:str="" class="xl68">长度为length的UTF-8编码的字节数</td></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Integer_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">整形字面量</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">3</td> <td rowspan="2" x:str="" class="xl67" style="border-bottom:none;">bytes-4</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">高位在前存储的int值</td></tr> <tr height="24" style="height:14.40pt;"></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Float_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">单精度浮点类型字面量</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">4</td> <td rowspan="2" x:str="" class="xl67" style="border-bottom:none;">bytes-4</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">高位在前存储的float值</td></tr> <tr height="24" style="height:14.40pt;"></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Long_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">长整形字面量</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">5</td> <td rowspan="2" x:str="" class="xl67" style="border-bottom:none;">bytes-8</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">高位在前存储的long值</td></tr> <tr height="24" style="height:14.40pt;"></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Double_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">双精度浮点类型字面量</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">6</td> <td rowspan="2" x:str="" class="xl67" style="border-bottom:none;">bytes-8</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">高位在前存储的double值</td></tr> <tr height="24" style="height:14.40pt;"></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Class_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">类或接口的符号引用</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">7</td> <td rowspan="2" x:str="" class="xl67" style="border-bottom:none;">index-2</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">指向全限定名常量项的索引</td></tr> <tr height="24" style="height:14.40pt;"></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_String_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">字符串类型字面量</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">8</td> <td rowspan="2" x:str="" class="xl67" style="border-bottom:none;">index-2</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">指向字符串字面量的索引<span style="mso-spacerun:yes;"> </span></td></tr> <tr height="24" style="height:14.40pt;"></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Fieldref_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">字段符号引用</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">9</td> <td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向CONSTANT_Class_info的索引</td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向CONSTANT_NameAndType的索引</td></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_Methodref_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">方法符号引用</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">10</td> <td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向CONSTANT_Class_info的索引</td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向CONSTANT_NameAndType的索引</td></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_InterfaceMethodref_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">接口中方法的符号引用</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">11</td> <td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向CONSTANT_Class_info的索引</td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向CONSTANT_NameAndType的索引</td></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_NameAndType_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">字段或方法的部分符号引用</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">12</td> <td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向该字段或方法名称常量项的索引</td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl67">index-2</td> <td x:str="" class="xl68">指向该字段或方法描述符常量项的索引</td></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_MethodHandle_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">方法句柄</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">15</td> <td x:str="" class="xl67">reference_kind-2</td> <td x:str="" class="xl68">方法类型</td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl67">reference_index-2</td> <td class="xl74"></td></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;border-bottom:none;">CONSTANT_MethodType_info</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">方法类型</td> <td rowspan="2" x:num="" class="xl71" style="border-bottom:none;">16</td> <td rowspan="2" x:str="" class="xl67" style="border-bottom:none;">descriptor_index-2</td> <td rowspan="2" x:str="" class="xl69" style="border-bottom:none;">方法描述符索引</td></tr> <tr height="24" style="height:14.40pt;"></tr> <tr height="24" style="height:14.40pt;"><td height="48" rowspan="2" x:str="" class="xl69" style="height:28.80pt;">CONSTANT_InvokeDynamic_info</td> <td rowspan="2" x:str="" class="xl69">动态方法调用点</td> <td rowspan="2" x:num="" class="xl71">18</td> <td x:str="" class="xl67">bootstrap_method_attr_index-2</td> <td class="xl74"></td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl67">name_and_type_index-2</td> <td class="xl74"></td></tr> <tr width="0" style="display:none;"><td width="304" style="width:182;"></td> <td width="236" style="width:142;"></td> <td width="98" style="width:59;"></td> <td width="267" style="width:160;"></td> <td width="319" style="width:191;"></td></tr></table></div> <center> 表0-0-4: 常量池类型（tag均占一个字节）</center> <ul><li>对该Test.clss常量池常量简要说明</li></ul> <blockquote><p>  常量池是从第十一个字节开始，0-0-1的第一排第六段开始，每一个常量项都包含一个字节的tag项作为开头，
表明常量的具体类型，该Test.class第一个常量项的tag则为0a，即10，对应表0-0-4查找说明该常量是：方法符号引用，
该常量有两个项目，一个是指向CONSTANT_Class_info的索引(2个字节，即00 04，#4)，第二个项目是指向CONSTANT_NameAndType的索引(2个字节，即00 15，#21),
<span style="color:blue;">so，第一个常量是这样的：#1(常量编号，上面说了常量池计数从1开始) 方法符号引用（常量类型） #4, #21(指向4号常量和21号常量);
第二个常量项的tag为09-类型是字段符号引用-两个索引#3(0003),#22(0016);第三个tag为07-类型为类或接口的符号引用-一个索引#23(0017);第四个tag为07-类型为类或接口的符号引用-一个索引#24(0018);第五个tag为1(01),表示UTF-8编码的字符串，
由一个2字节长度0004，即表示该常量字符串由4个自己组成，即6e616d65，对应的字母分别是name;</span>后面查找方法一样，直至第20行第一个字节74结束。最后可参考0-0-2的Constant pool部分验证。</p></blockquote> <h3 id="access-flags-访问标志">access_flags（访问标志）</h3> <table><tr><th style="width:180px;">标志名称</th> <th style="width:150px;text-align:center;">值</th> <th style="width:500px;">描述</th></tr> <tr><td>ACC_PUBLIC</td> <td style="text-align:center;">0x0001</td> <td>public</td></tr> <tr><td>ACC_FINAL</td> <td style="text-align:center;">0x0010</td> <td>final</td></tr> <tr><td>ACC_SUPER</td> <td style="text-align:center;">0x0020</td> <td>当用到invokespecial指令时，需要特殊处理的超类方法</td></tr> <tr><td>ACC_ABSTRACT</td> <td style="text-align:center;">0x0400</td> <td></td></tr> <tr><td>ACC_SYNTHETIC</td> <td style="text-align:center;">0x1000</td> <td>synthetic,标识非Java代码生成的</td></tr> <tr><td>ACC_ANNOTATION</td> <td style="text-align:center;">0x2000</td> <td></td></tr> <tr><td>ACC_ENUM</td> <td style="text-align:center;">0x4000</td> <td></td></tr></table> <center> 表0-0-5: 类或接口访问标志</center> <blockquote><p>  紧跟在常量池之后的2个字节为访问标志，用于表示当前字节文件属于一个类、接口、注解或枚举，其访问权限，是否为抽象类，是否不可派生等。
该Test.class的访问标识位于片段0-0-1的第20行的第2、3字节（00 21），是由0x0020^0x0001所得，即其访问标志为public和super，
如果是public final class，其标识值为0x0031,是由0x0020^0x0001^0x0010所得。</p></blockquote> <h3 id="类索引、超类索引">类索引、超类索引</h3> <blockquote><p>  访问标志后面的是2个字节的类索引#3(0003)和2个字节的超类索引#4(0004)，查看常量池可知其分别为com/tab/test_05/Test、java/lang/Object</p></blockquote> <h3 id="接口计数器、接口表">接口计数器、接口表</h3> <blockquote><p>  紧跟着的是2个字节的接口计数器，片段0-0-1中为0000，即没有接口，所以接口表也不存在，将Test.java实现Serializable接口后，其接口计数器为0001，表示有一个接口
所以后面接口表中就有一个2字节的类或接口的符号引用0005，5号常量为<code>#5 = Class #26 // java/io/Serializable</code>；同时实现Serializable和Comparable接口时，其接口计数器为0002，表示有两个接口，那后面
的接口表就包括2个2字节的类或接口的符号引用，分别为0005、0006，其对应的常量分别为<code>#5 = Class #26 // java/io/Serializable</code>、<code>#6 = Class #32 // java/lang/Comparable</code>(实现Serializable，Comparable接口的字节码及字节码指令此处未全部展示)。</p></blockquote> <h3 id="字段计数器、字段表">字段计数器、字段表</h3> <blockquote><p>  字段计数器用于表示一个class文件中的类变量和实例变量的数量综合，此例中为0001，表示一个字段，再其后的为字段表，字段表为一个数组集合，每一个成员的结构如下：</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>field_info {
    //字段访问修饰符，如表0-0-6示 
    u2 access_flags;                                该例中：  0002-private
    u2 name_index; //指向常量池的有效索引                      0005-#5-name
    u2 descriptor_index; //指向常量池的有效索引                0006-#6-Ljava/lang/String;
    u2 attributes_count; //指明后续那个attributes[]的长度      0000
    //具体的attributes[] 每一个成员都是attribute_info结构
    attribute_info attributes[attributes_count];              无
}    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>attribute_info可查看<a href="#001">属性表</a> <table><tr><th style="width:180px;">标志名称</th> <th style="width:150px;text-align:center;">值</th> <th style="width:500px;">描述</th></tr> <tr><td>ACC_PUBLIC</td> <td style="text-align:center;">0x0001</td> <td></td></tr> <tr><td>ACC_PRIVATE</td> <td style="text-align:center;">0x0002</td> <td></td></tr> <tr><td>ACC_PROTECTED</td> <td style="text-align:center;">0x0004</td> <td></td></tr> <tr><td>ACC_STATIC</td> <td style="text-align:center;">0x0008</td> <td></td></tr> <tr><td>ACC_FINAL</td> <td style="text-align:center;">0x0010</td> <td></td></tr> <tr><td>ACC_VOLATILE</td> <td style="text-align:center;">0x0040</td> <td></td></tr> <tr><td>ACC_TRANSIENT</td> <td style="text-align:center;">0x0080</td> <td></td></tr> <tr><td>ACC_SYNTHETIC</td> <td style="text-align:center;">0x1000</td> <td>声明一个字段由编译器自动产生</td></tr> <tr><td>ACC_ENUM</td> <td style="text-align:center;">0x4000</td> <td>声明一个枚举类型的变量</td></tr></table> <center> 表0-0-6: 字段访问标志</center></p> <h3 id="方法计数器、方法表">方法计数器、方法表</h3> <blockquote><p>之后的时字段计数器和字段表，都仅包括当前类或接口的方法，不包括超类的，方法表也是一个数组集合，每个成员都是一个method_info结构的数据项，其结构如下</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>method_info{
    u2 access_flag; //方法访问标志 如表0-0-7
    u2 name_index;
    u2 descriptor_index;
    u2 attributes_count;
    attribute_info attributes[attributes_count];
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><table><tr><th style="width:180px;">标志名称</th> <th style="width:150px;text-align:center;">值</th> <th style="width:500px;">描述</th></tr> <tr><td>ACC_PUBLIC</td> <td style="text-align:center;">0x0001</td> <td></td></tr> <tr><td>ACC_PRIVATE</td> <td style="text-align:center;">0x0002</td> <td></td></tr> <tr><td>ACC_PROTECTED</td> <td style="text-align:center;">0x0004</td> <td></td></tr> <tr><td>ACC_STATIC</td> <td style="text-align:center;">0x0008</td> <td></td></tr> <tr><td>ACC_FINAL</td> <td style="text-align:center;">0x0010</td> <td></td></tr> <tr><td>ACC_SYNCHRONIZED</td> <td style="text-align:center;">0x0020</td> <td></td></tr> <tr><td>ACC_BRIDGE</td> <td style="text-align:center;">0x0040</td> <td>将方法声明为bridge</td></tr> <tr><td>ACC_VARARGS</td> <td style="text-align:center;">0x0080</td> <td>表示方法带有边长参数</td></tr> <tr><td>ACC_NATIVE</td> <td style="text-align:center;">0x0100</td> <td>本地方法</td></tr> <tr><td>ACC_ABSTRACT</td> <td style="text-align:center;">0x0400</td> <td></td></tr> <tr><td>ACC_STRICT</td> <td style="text-align:center;">0x0800</td> <td>将方法声明为strictfp，表示FP-strict浮点格式</td></tr> <tr><td>ACC_SYNTHETIC</td> <td style="text-align:center;">0x1000</td> <td></td></tr></table> <center> 表0-0-7: 方法访问标志</center> <blockquote><p>该例方法计数器字节码于21行第4、5字节0004，表示该类中有4个方法，分析如下：</p></blockquote> <table width="750.00" border="0" cellpadding="0" cellspacing="0" style="width:740px;border-collapse:collapse;table-layout:fixed;"><col width="81" class="xl65" style="mso-width-source:userset;mso-width-alt:2369;"> <col width="176" class="xl65" style="mso-width-source:userset;mso-width-alt:5149;"> <col width="158" class="xl65" style="mso-width-source:userset;mso-width-alt:4622;"> <col width="244" class="xl65" style="mso-width-source:userset;mso-width-alt:7138;"> <col width="188" class="xl65" style="mso-width-source:userset;mso-width-alt:5500;"> <col width="232.00" class="xl65" style="mso-width-source:userset;mso-width-alt:6787;"> <col width="182" class="xl65" style="mso-width-source:userset;mso-width-alt:5324;"> <col width="273.00" class="xl65" style="mso-width-source:userset;mso-width-alt:7986;"> <col width="81" span="16376" class="xl65" style="mso-width-source:userset;mso-width-alt:2369;"> <tr height="24" style="height:14.40pt;"><td height="48" width="81" rowspan="2" x:str="" class="xl66" style="height:28.80pt;width:48.60pt;border-right:none;border-bottom:none;">序号</td> <td width="176" rowspan="2" x:str="" class="xl67" style="width:105.60pt;border-right:none;border-bottom:none;">access_flag(u2)</td> <td width="158" rowspan="2" x:str="" class="xl68" style="width:94.80pt;border-right:none;border-bottom:none;">name_index(u2)</td> <td width="244" rowspan="2" x:str="" class="xl66" style="width:146.40pt;border-right:none;border-bottom:none;">descriptor_index(u2)</td> <td width="188" rowspan="2" x:str="" class="xl68" style="width:112.80pt;border-right:none;border-bottom:none;">attributes_count(u2)</td> <td width="687" colspan="3" x:str="" class="xl68" style="width:412.20pt;border-right:none;border-bottom:none;">attribute_info attributes</td></tr> <tr height="24" style="height:14.40pt;"><td x:str="" class="xl69">attribute_name_index(u2)</td> <td x:str="" class="xl65">attribute_length(u4)</td> <td x:str="" class="xl65">u1 info[attribute_length]</td></tr> <tr height="24" style="height:14.40pt;"><td height="24" x:num="" class="xl66" style="height:14.40pt;">1</td> <td x:str="" class="xl65">public(0001)</td> <td x:str="" class="xl66">&lt;init&gt;(0007)</td> <td x:str="" class="xl66">()V(0008)</td> <td x:str="" class="xl66">1(0001)</td> <td x:str="" class="xl66">Code(0009)</td> <td x:str="" class="xl66">47(0000002f)</td> <td x:str="" class="xl65">[22行第4个字节-25行第2个字节]</td></tr> <tr height="24" style="height:14.40pt;"><td height="24" x:num="" class="xl66" style="height:14.40pt;">2</td> <td x:str="" class="xl65">public(0001)</td> <td x:str="" class="xl66">getName(000e)</td> <td x:str="" class="xl65">()Ljava/lang/String(000f)</td> <td x:str="" class="xl66">1(0001)</td> <td x:str="" class="xl66">Code(0009)</td> <td x:str="" class="xl66">47(0000002f)</td> <td x:str="" class="xl65">[26行-28行倒数第二个字节]</td></tr> <tr height="24" style="height:14.40pt;"><td height="24" x:num="" class="xl66" style="height:14.40pt;">3</td> <td x:str="" class="xl65">public(0001)</td> <td x:str="" class="xl66">setName(0010)</td> <td x:str="" class="xl65">(Ljava/lang/String;)V(0011)</td> <td x:str="" class="xl66">1(0001)</td> <td x:str="" class="xl66">Code(0009)</td> <td x:str="" class="xl66">62(0000003e)</td> <td x:str="" class="xl65">[29行第14个字节-33第11个字节]</td></tr> <tr height="24" style="height:14.40pt;"><td height="24" x:num="" class="xl66" style="height:14.40pt;">4</td> <td x:str="" class="xl65">public static(0009)</td> <td x:str="" class="xl66">doSomething(0012)</td> <td x:str="" class="xl66">()V(0008)</td> <td x:str="" class="xl66">1(0001)</td> <td x:str="" class="xl66">Code(0009)</td> <td x:str="" class="xl66">25(00000019)</td> <td x:str="" class="xl65">[34行第10个字节-36行第2个字节]</td></tr></table> <blockquote><p>第四个方法的访问标志字节码为0009是由0x0001^0008所得</p></blockquote> <h3 id="属性计数器、属性表">属性计数器、属性表</h3> <blockquote><p>再之后的则为属性计数器，用以表示当前字节码文件中的属性个数，属性表则为属性计数器计数数量的attribute_info的数组集合,<a href="#001">attribute_info结构</a></p></blockquote> <blockquote><p>该例中属性计数器字节在36行第3、4字节0001，其后字节为该属性字节，0013-SourceFile，结合<a href="#002">SourceFile结构表</a>可知，其attribute_length为00000002，sourcefile_index为0014即#20-Test.java</p></blockquote> <p id="001"></p> <h3 id="属性表">属性表</h3> <blockquote><p>属性存在于ClassFile、field_info、method_info和Code_attribute项中，其结构如下：</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>attribute_info {
    //指向常量池中的CONSTANT_UTF8_info常量项索引，如此可获取当前属性的简单名称
    u2 attribute_name_index; 
    u4 attribute_length; //指明后续info数组长度
    //虚拟机规范共定义了21中预定义属性，java虚拟机必须识别的有
    //Code、ConstantValue、Exception、InnerClass、EnclosingMethod和Synthetic
    u1 info[attribute_length]; 
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>Code属性位于method_info项的属性表中，主要存储方法的字节码指令以及其他一些辅助信息，当然如果为抽象方法或本地方法就不含Code属性了,Code属性结构如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>Code_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;Code&quot;
    u2 attribute_name_index;
    u4 attribute_length;
    u2 max_stack;  //当前方法操作数栈的最大深度
    u2 max_locals;   //当前方法的局部变量表所需的存储空间长度
    u4 code_length; //后续code[]的长度，必须大于0
    u1 code[code_length];   //该code[]中的成员就是方法的字节码
    u2 exception_table_length;//后续exception_table长度
    //每一项都是exception_attribute结构信息
    exception_info exception_table[exception_table_length]; 
    u2 attributes_count;
    attribute_info attributes[attribute_count]; //attribute_info结构项
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>ConstantValue属性位于field_info项属性表中，该属性用于通知虚拟机对类变量执行初始化操作。类变量的初始化操作有两种，
一种由初始化方法&lt;clinit&gt;()完成，另一种则由ConstantValue属性完成。如果类变量为常量，且为原始数据类型或String类型，
则被ConstantValue属性执行初始化操作，否则该类变量则只能由&lt;clinit&gt;()方法完成。ConstantValue属性结构如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>constantValue_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;ConstantValue&quot;
    u2 attribute_name_index;
    u4 attribute_length; //永远固定为2
    u2 constantvalue_index; //指向常量项中的有效索引
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>Exceptions属性位于method_info中，该属性主要用于列举当前方法通过关键字throws可能抛出的异常信息,其表结构如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>Exceptions_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;Exceptions&quot;
    u2 attribute_name_index;
    u4 attribute_length;
    u2 number_of_exceptions;
    u2 exception_index_table[number_of_exceptions];
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>LineNumberTable属性用于描述Java代码中行号与字节码文件中的字节码行号之间的对应关系，比如程序异常时，打印的堆栈信息行号。其结构如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>LineNumberTable_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;LineNumberTable&quot;
    u2 attribute_name_index;
    u4 attribute_length;
    u2 line_number_table_length;
    line_number_info line_number_table;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><p id="002">SourceFile属性用于记录生成字节码文件的源文件名称。其结构如下：</p></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>LineNumberTable_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;SourceFile&quot;
    u2 attribute_name_index;
    u4 attribute_length; //固定为2
    u2 sourcefile_index;//指向常量池列表的索引，通过该索引可获取该源文件名称
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>LocalVariableTable属性用于描述局部变量表中局部变量与Java代码中定义的变量之间的对应关系,位于Code_attribute项中。其结构如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>LocalVariableTable_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;LocalVariableTable&quot;
    u2 attribute_name_index;
    u4 attribute_length; 
    u2 local_variable_table_length;
    local_variable_info local_variable_table;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>InnerClass属性用于描述内部类与宿主类之间的关联关系，该属性位于ClassFile的疏星表中，InnerClass表结构如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>InnerClasses_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;InnerClass&quot;
    u2 attribute_name_index;
    u4 attribute_length;
    u2 number_of_classes;
    inner_classes_info inner_classes;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>BootstrapMethods属性位于ClassFile的属性表中，用于保存invokedynamic指令引用的引导方法限定符。如果说常量池中有CONSTANT_InvokeDynamic_info常量项的话，
那么ClassFile结构的属性表中就必须有一个BootstrapMethods属性，其表结构如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>BootstrapMethods_attribute {
    //指向常量池的有效索引，通过该索引获取当前属性简单名称，其实就是&quot;BootstrapMethods&quot;
    u2 attribute_name_index;
    u4 attribute_length;
    u2 num_bootstrap_methods;
    bootstrap_method bootstrap_methods;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/hellof/java/load.html">
        类加载机制
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hellof/assets/js/app.eec69b23.js" defer></script><script src="/hellof/assets/js/2.c60f8f4a.js" defer></script><script src="/hellof/assets/js/34.be2de1e0.js" defer></script>
  </body>
</html>
