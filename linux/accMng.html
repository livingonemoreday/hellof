<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>用户账号 | 虚心若愚 求知若渴</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/hellof/static/pictures/eagle.png">
    <meta name="description" content=" ">
    
    <link rel="preload" href="/hellof/assets/css/0.styles.2339d483.css" as="style"><link rel="preload" href="/hellof/assets/js/app.22404478.js" as="script"><link rel="preload" href="/hellof/assets/js/2.488c7013.js" as="script"><link rel="preload" href="/hellof/assets/js/42.34c364c8.js" as="script"><link rel="prefetch" href="/hellof/assets/js/10.151448d0.js"><link rel="prefetch" href="/hellof/assets/js/11.60f7af50.js"><link rel="prefetch" href="/hellof/assets/js/12.cb6c99d0.js"><link rel="prefetch" href="/hellof/assets/js/13.75e02d05.js"><link rel="prefetch" href="/hellof/assets/js/14.56817cd5.js"><link rel="prefetch" href="/hellof/assets/js/15.2758bc88.js"><link rel="prefetch" href="/hellof/assets/js/16.646aad62.js"><link rel="prefetch" href="/hellof/assets/js/17.235d0eb2.js"><link rel="prefetch" href="/hellof/assets/js/18.6a4ea89b.js"><link rel="prefetch" href="/hellof/assets/js/19.929fc64b.js"><link rel="prefetch" href="/hellof/assets/js/20.8169d0fe.js"><link rel="prefetch" href="/hellof/assets/js/21.3c7a441d.js"><link rel="prefetch" href="/hellof/assets/js/22.670a6446.js"><link rel="prefetch" href="/hellof/assets/js/23.e5f3eb97.js"><link rel="prefetch" href="/hellof/assets/js/24.c084dba4.js"><link rel="prefetch" href="/hellof/assets/js/25.9634dc26.js"><link rel="prefetch" href="/hellof/assets/js/26.71251709.js"><link rel="prefetch" href="/hellof/assets/js/27.f380250d.js"><link rel="prefetch" href="/hellof/assets/js/28.34edf848.js"><link rel="prefetch" href="/hellof/assets/js/29.12661fea.js"><link rel="prefetch" href="/hellof/assets/js/3.f7339565.js"><link rel="prefetch" href="/hellof/assets/js/30.88d243e8.js"><link rel="prefetch" href="/hellof/assets/js/31.0e0b8053.js"><link rel="prefetch" href="/hellof/assets/js/32.b1461f5a.js"><link rel="prefetch" href="/hellof/assets/js/33.147fdbc3.js"><link rel="prefetch" href="/hellof/assets/js/34.950caae2.js"><link rel="prefetch" href="/hellof/assets/js/35.6a8125a1.js"><link rel="prefetch" href="/hellof/assets/js/36.d22f7ca9.js"><link rel="prefetch" href="/hellof/assets/js/37.91738ca1.js"><link rel="prefetch" href="/hellof/assets/js/38.84e04bd1.js"><link rel="prefetch" href="/hellof/assets/js/39.da04fefc.js"><link rel="prefetch" href="/hellof/assets/js/4.11d6af14.js"><link rel="prefetch" href="/hellof/assets/js/40.8471f14f.js"><link rel="prefetch" href="/hellof/assets/js/41.6e481f1f.js"><link rel="prefetch" href="/hellof/assets/js/43.d4f40ef1.js"><link rel="prefetch" href="/hellof/assets/js/44.46f99a49.js"><link rel="prefetch" href="/hellof/assets/js/45.55fcb768.js"><link rel="prefetch" href="/hellof/assets/js/46.497903b2.js"><link rel="prefetch" href="/hellof/assets/js/47.0d891ef2.js"><link rel="prefetch" href="/hellof/assets/js/48.0885ad9e.js"><link rel="prefetch" href="/hellof/assets/js/49.415b1ea4.js"><link rel="prefetch" href="/hellof/assets/js/5.b3c64add.js"><link rel="prefetch" href="/hellof/assets/js/50.a11ed575.js"><link rel="prefetch" href="/hellof/assets/js/51.9523ab07.js"><link rel="prefetch" href="/hellof/assets/js/52.3f122d39.js"><link rel="prefetch" href="/hellof/assets/js/53.cb20ac87.js"><link rel="prefetch" href="/hellof/assets/js/54.8f6eefdf.js"><link rel="prefetch" href="/hellof/assets/js/55.6c23ebc6.js"><link rel="prefetch" href="/hellof/assets/js/56.e6c7ee57.js"><link rel="prefetch" href="/hellof/assets/js/57.d37c28eb.js"><link rel="prefetch" href="/hellof/assets/js/58.8d9b7ddb.js"><link rel="prefetch" href="/hellof/assets/js/59.be25e66d.js"><link rel="prefetch" href="/hellof/assets/js/6.eb3c2428.js"><link rel="prefetch" href="/hellof/assets/js/60.66e0bb3a.js"><link rel="prefetch" href="/hellof/assets/js/61.597ad7ae.js"><link rel="prefetch" href="/hellof/assets/js/62.d7449c53.js"><link rel="prefetch" href="/hellof/assets/js/63.1aa39cfd.js"><link rel="prefetch" href="/hellof/assets/js/64.b4626a5e.js"><link rel="prefetch" href="/hellof/assets/js/65.4baaff71.js"><link rel="prefetch" href="/hellof/assets/js/66.9feb0224.js"><link rel="prefetch" href="/hellof/assets/js/67.47aefdd0.js"><link rel="prefetch" href="/hellof/assets/js/68.96b9a36c.js"><link rel="prefetch" href="/hellof/assets/js/69.28cc6952.js"><link rel="prefetch" href="/hellof/assets/js/7.9a417936.js"><link rel="prefetch" href="/hellof/assets/js/70.68fe6dd8.js"><link rel="prefetch" href="/hellof/assets/js/71.fd343b89.js"><link rel="prefetch" href="/hellof/assets/js/72.bd7a0413.js"><link rel="prefetch" href="/hellof/assets/js/73.b5f2bc6f.js"><link rel="prefetch" href="/hellof/assets/js/74.6791830d.js"><link rel="prefetch" href="/hellof/assets/js/8.c5650d23.js"><link rel="prefetch" href="/hellof/assets/js/9.c9f6972b.js">
    <link rel="stylesheet" href="/hellof/assets/css/0.styles.2339d483.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hellof/" class="home-link router-link-active"><!----> <span class="site-name">虚心若愚 求知若渴</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hellof/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/hellof/java/class.html" class="nav-link">
  JAVA
</a></div><div class="nav-item"><a href="/hellof/frontEnd/css/selector.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/hellof/db/mysql/executionPlan.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><a href="/hellof/linux/fileDirMg.html" class="nav-link">
  LINUX
</a></div><div class="nav-item"><a href="/hellof/python.html" class="nav-link">
  PYTHON
</a></div><div class="nav-item"><a href="/hellof/openFrame/others.html" class="nav-link">
  开源框架
</a></div><div class="nav-item"><a href="/hellof/tools/giteeVuePress.html" class="nav-link">
  工具
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hellof/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/hellof/java/class.html" class="nav-link">
  JAVA
</a></div><div class="nav-item"><a href="/hellof/frontEnd/css/selector.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/hellof/db/mysql/executionPlan.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><a href="/hellof/linux/fileDirMg.html" class="nav-link">
  LINUX
</a></div><div class="nav-item"><a href="/hellof/python.html" class="nav-link">
  PYTHON
</a></div><div class="nav-item"><a href="/hellof/openFrame/others.html" class="nav-link">
  开源框架
</a></div><div class="nav-item"><a href="/hellof/tools/giteeVuePress.html" class="nav-link">
  工具
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/hellof/linux/diskandfilesystem.html" class="sidebar-link">磁盘，文件系统</a></li><li><a href="/hellof/linux/fileDirMg.html" class="sidebar-link">文件目录管理</a></li><li><a href="/hellof/linux/vim.html" class="sidebar-link">VIM</a></li><li><a href="/hellof/linux/bash.html" class="sidebar-link">BASH</a></li><li><a href="/hellof/linux/reg.html" class="sidebar-link">正则与文件格式化</a></li><li><a href="/hellof/linux/shell.html" class="sidebar-link">SHELL</a></li><li><a href="/hellof/linux/accMng.html" aria-current="page" class="active sidebar-link">账号管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#用户账号" class="sidebar-link">用户账号</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#etc-passwd" class="sidebar-link">/etc/passwd</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#etc-shadow" class="sidebar-link">/etc/shadow</a></li></ul></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#用户组" class="sidebar-link">用户组</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#etc-group" class="sidebar-link">/etc/group</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#有效-初始用户组" class="sidebar-link">有效/初始用户组</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#etc-gshadow" class="sidebar-link">/etc/gshadow</a></li></ul></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#账号管理" class="sidebar-link">账号管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#useradd" class="sidebar-link">useradd</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#passwd" class="sidebar-link">passwd</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#change" class="sidebar-link">change</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#usermod" class="sidebar-link">usermod</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#userdel" class="sidebar-link">userdel</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#id" class="sidebar-link">id</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#chfn" class="sidebar-link">chfn</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#chsh-change-shell" class="sidebar-link">chsh（change shell)</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#新增删除用户组" class="sidebar-link">新增删除用户组</a></li></ul></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#acl" class="sidebar-link">ACL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#setfacl" class="sidebar-link">setfacl</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#getfacl" class="sidebar-link">getfacl</a></li></ul></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#用户身份切换" class="sidebar-link">用户身份切换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#su" class="sidebar-link">su</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#sudo" class="sidebar-link">sudo</a></li></ul></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#sbin-nologin" class="sidebar-link">/sbin/nologin</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#用户信息传递" class="sidebar-link">用户信息传递</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#查询用户" class="sidebar-link">查询用户</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#用户对话" class="sidebar-link">用户对话</a></li><li class="sidebar-sub-header"><a href="/hellof/linux/accMng.html#用户邮箱" class="sidebar-link">用户邮箱</a></li></ul></li></ul></li><li><a href="/hellof/linux/crontab.html" class="sidebar-link">计划任务</a></li><li><a href="/hellof/linux/ftp.html" class="sidebar-link">FTP</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="用户账号">用户账号</h2> <h3 id="etc-passwd">/etc/passwd</h3> <p>里面有很多账号是系统正常运行所必需的，即系统账号，eg:bin、daemon、nobody等，不可随意删除。</p> <ul><li><p>账号名称</p></li> <li><p>密码</p></li> <li><p>UID
<table><tr><th style="width:200px;text-align:center;">ID范围</th> <th style="width:600px;text-align:left;">特性</th></tr> <tr><td style="text-align:center;">0（系统管理员）</td> <td>将UID改为0，即可系统管理员，but，不建议多个账号的UID为0，易混乱</td></tr> <tr><td style="text-align:center;">1-999（系统账号）</td> <td>系统上启动的网络服务或后台服务希望使用较小的权限去运行，不希望root身份去执行，所以需要提供这些运行中程序的拥有者账号。这些账号通常是不可登录的。</td></tr> <tr><td style="text-align:center;">1-60000（可登录账号）</td> <td>目前已支持2^32-1的UID号码</td></tr></table></p></li> <li><p>GID</p></li> <li><p>用户信息说明栏</p></li> <li><p>家目录
若想要将账号家目录移到其他位置，可修改改字段</p></li> <li><p>shell
为用户指定默认的shell</p></li></ul> <h3 id="etc-shadow">/etc/shadow</h3> <ul><li>账号名称</li> <li>密码<br>
在该字段前加上!或*会让密码暂时失效</li> <li>最近修改密码的日期<br>
此字段记录的是在1970/1/1基础上累加的天数</li> <li>密码不可被修改的天数<br>
若为0表示可随时更改</li> <li>密码需要重新修改的天数</li> <li>密码需要修改期限前的警告天数</li> <li>密码过期后的宽限时间<br>
密码过期特性：密码过期后在宽限期内需要重新设置密码方能登录继续使用。<br>
若超过宽限期，则密码失效，就无法登录。</li> <li>账号失效日期<br>
1970/1/1之后的天数。账号在此日期后不管密码是否过期都将无法再使用。可用于收费服务，规定一个日期使账号不能使用。</li> <li>保留</li></ul> <h2 id="用户组">用户组</h2> <h3 id="etc-group">/etc/group</h3> <div class="language- extra-class"><pre><code>[yu@104 ~]$ head -n 2 /etc/group
root:x:0:
bin:x:1:
</code></pre></div><ul><li>组名</li> <li>用户组密码</li> <li>GID</li> <li>此用户组支持的账号名称</li></ul> <h3 id="有效-初始用户组">有效/初始用户组</h3> <ul><li>/etc/passwd中记录的GID即为初始用户组，当用户一登陆系统，就会拥有该用户组的相关权限，所以不需要在/etc/group的第四个字段写入该账号</li> <li>groups: 可查看当前账号支持的用户组，第一个输出的即为有效用户组，作用是用于创建文件目录</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ groups
yu jason 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>newgrp: 以另外一个shell来切换有效用户组，so，<code>操作完之后需要exit退回到之前的环境</code></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ newgrp jason
[yu@104 ~]$ groups
jason yu
[yu@104 ~]$ mkdir c
[yu@104 ~]$ ll
drwxr-xr-x. 2 yu jason 6 11月 23 11:19 c
[yu@104 ~]$ exit
exit
[yu@104 ~]$ groups
yu jason
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="etc-gshadow">/etc/gshadow</h3> <div class="language- extra-class"><pre><code>[root@104 ~]# head -n 2 /etc/gshadow
root:::
bin:::
</code></pre></div><ul><li>组名</li> <li>密码栏</li> <li>用户组管理员的账号（/etc/gpasswd）</li> <li>有加入该组的账号（与/etc/group同）</li></ul> <h2 id="账号管理">账号管理</h2> <h3 id="useradd">useradd</h3> <h4 id="useradd-u-uid-g-初始用户组-g-次要用户组-mm-c-说明栏-d-家目录绝对路径-s-shell-账号名称">useradd [-u UID] [-g 初始用户组] [-G 次要用户组] [-mM] [-c 说明栏] [-d 家目录绝对路径] [-s shell] 账号名称</h4> <ul><li>-M: 不要建立家目录，系统账号默认</li> <li>-m: 建立家目录，一般账号默认</li> <li>-r: 建立一个系统账号，系统默认不会建立家目录</li> <li>-s: 默认为/bin/bash</li> <li>-e: 账号失效日期设置，格式为:YYYY-MM-dd</li> <li>-f: shadow第7栏目，0为立刻失效，-1永远不失效，只是过期强制登录时重新设置</li></ul> <h4 id="useradd参考文件">useradd参考文件</h4> <h5 id="etc-default-useradd">/etc/default/useradd</h5> <div class="language- extra-class"><pre><code>[root@104 ~]# useradd -D
GROUP=100
HOME=/home
INACTIVE=-1            #shadow第7栏
EXPIRE=                #shadow第8栏
SHELL=/bin/bash
SKEL=/etc/skel         #家目录内容参考
CREATE_MAIL_SPOOL=yes  #是否主动建立邮箱
</code></pre></div><ul><li>GROUP=100: 新建用户的初始用户组ID为100，but，centOS默认用户组与账号名相同，why?针对用户组有两种机制：
<ul><li>私有用户组机制：系统建立一个与账号一样的用户组给用户作为初始用户组，此机制比较有保密性，家目录权限将设置为700，该机制不会参考GROUP=100，代表发行版有RHEL，CentOS等</li> <li>公共用户组机制：以GROUP=100设置值作为新建账号的初始用户组，每个账号都属于那个组，so，彼此可共享家目录的数据，代表发行版SUSE等。</li></ul></li> <li>SKEL=/etc/skel：家目录内的文件数据是由该目录下的数据cp过去的</li></ul> <h5 id="etc-skel">/etc/skel/</h5> <div class="language- extra-class"><pre><code>[yu@104 ~]$ ls -al /etc/skel/
总用量 24
drwxr-xr-x.  2 root root   62 4月  11 2018 .
drwxr-xr-x. 78 root root 8192 11月 23 11:04 ..
-rw-r--r--.  1 root root   18 10月 31 2018 .bash_logout
-rw-r--r--.  1 root root  193 10月 31 2018 .bash_profile
-rw-r--r--.  1 root root  231 10月 31 2018 .bashrc
</code></pre></div><h5 id="etc-login-defs">/etc/login.defs</h5> <div class="language- extra-class"><pre><code>[yu@104 ~]$  egrep -v &quot;^#|^$&quot; /etc/login.defs 
MAIL_DIR	/var/spool/mail     #邮箱
PASS_MAX_DAYS	99999           #shadow第5栏
PASS_MIN_DAYS	0               #shadow第4栏
PASS_MIN_LEN	5               #密码最短字符串，已被pam模块替换
PASS_WARN_AGE	7               #shadow第6栏
UID_MIN                  1000   #使用者最小UID
UID_MAX                 60000
SYS_UID_MIN               201   #系统账号最小ID
SYS_UID_MAX               999
GID_MIN                  1000
GID_MAX                 60000
SYS_GID_MIN               201
SYS_GID_MAX               999
CREATE_HOME	yes                 #不加-mM时，是否主动建立家目录
UMASK           077             #家目录umask
USERGROUPS_ENAB yes             #userdel时是否删除初始用户组
ENCRYPT_METHOD SHA512           #密码加密机制
</code></pre></div><ul><li>UID/GID指定值： 当设置一个账号时，首先会参考UID_MIN来获取最小值，从/etc/passwd来获取最大值，从二者中获取最大值+1设置为新账号UID</li></ul> <h3 id="passwd">passwd</h3> <ul><li>passwd [--stdin] [账号名称] #所有人均可使用</li> <li>passwd [-l] [-u] [--stdin] [-S] [-n 日数] [-x 日数] [-w 日数] [-i 日期] 账号 #root功能
<ul><li>--stdin: 可以通过来自前一个管道的数据，作为密码输入，对shell脚本有帮助</li> <li>-l: lock之意，将/etc/shadow第2栏最前面加上!使密码失效</li> <li>-u: unlock之意</li> <li>-n/x/w/i: shadow第4/5/6/7栏位</li></ul></li></ul> <h3 id="change">change</h3> <ul><li>change [-ldEImMW] 账号名
<ul><li>-l: 列出该账号的详细密码参数</li> <li>-d/E: 接日期，shadow第3/8位，格式位：YYYY-MM-DD</li> <li>-I/m/M/W: 接天数，shadow第7/4/5/6位</li> <li>change -d 0 用户名，可强制用户在第一次登录时必须修改密码后才能使用系统资源</li></ul></li></ul> <h3 id="usermod">usermod</h3> <ul><li>usermod [-cdegGlsuLU] username
<ul><li>-c: /etc/passwd第5栏</li> <li>-d: 家目录</li> <li>-e: /etc/shadow第8栏</li> <li>-f: shadow第7栏</li> <li>-g/G: 初始/次要用户组</li> <li>-l: 接账号名称，修改用户名称，passwd第1栏</li> <li>-s: 后面接shell文件</li> <li>-u: 后面接UID数字</li> <li>-L: 暂时将使用者密码冻结，使其无法登录，</li> <li>-U: 解锁</li></ul></li></ul> <h3 id="userdel">userdel</h3> <ul><li>userdel [-r] username
<ul><li>-r: 连同家目录一起删掉</li></ul></li></ul> <h3 id="id">id</h3> <ul><li>id username</li></ul> <h3 id="chfn">chfn</h3> <ul><li>chfn [-foph] username
<ul><li>-f: 接完整大名</li> <li>-o: 办公室房间号码</li> <li>-p: 办公室电话号码</li> <li>-h: 家里电话号码</li></ul></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ chfn
Changing finger information for yu.
名称 []: yufl
办公 []: 110
办公电话 []: 9527
住宅电话 []: 222

密码：
Finger information changed.
[yu@104 ~]$ grep 'yu' /etc/passwd
yu:x:1001:1001:yufl,110,9527,222:/home/yu:/bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="chsh-change-shell">chsh（change shell)</h3> <ul><li>chsh [-ls]
<ul><li>-l: 列出系统可用shell，即/etc/shells的内容</li> <li>-s: 设置修改自己的shell</li></ul></li></ul> <h3 id="新增删除用户组">新增删除用户组</h3> <ul><li>groupadd [-g gid] [-r] 用户组名称
<ul><li>-g gid: 设置gid</li> <li>-r: 建立系统用户组</li></ul></li> <li>groupmod [-g gid] [-n groupName] 用户组名</li> <li>groupdel groupName</li> <li>gpasswd
<ul><li>gpasswd groupname
<ul><li>给groupname组设置密码</li></ul></li> <li>gpasswd [-A user1,...] [-M userA,...] groupname
<ul><li>-A: 将groupname的管理权交给user1,...</li> <li>-M: 将userA,...等用户加入groupname组</li></ul></li> <li>gpasswd [-ad] user groupname
<ul><li>-a: 将user加入groupname组中</li> <li>-d: 将user从groupname中移除</li></ul></li> <li>gpasswd [-Rr] groupname
<ul><li>-r: 将groupname的密码删除</li> <li>-R: 将groupname的密码栏失效</li></ul></li></ul></li></ul> <h2 id="acl">ACL</h2> <blockquote><p>Access Control List，提供user/group/others以外的详细权限设置，可以对单一用户，单一文件目录进行权限设置。</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master ~]# dmesg | grep -i acl
[    1.512137] systemd[1]: systemd 219 running in system mode. (+PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 -SECCOMP +BLKID +ELFUTILS +KMOD +IDN)
[    3.777653] SGI XFS with ACLs, security attributes, no debug enabled
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>对于xfs文件系统已默认支持ACL</code></p> <h3 id="setfacl">setfacl</h3> <ul><li>setfacl [-bkRd] [{-m|-x} acl参数] filename
<ul><li>-m: 设置acl参数权限</li> <li>-x: 删除acl参数权限</li> <li>-b: 删除所有的ACL权限</li> <li>-R: 递归设置acl参数
<code>acl参数 用u:user:权限/g:group:权限/m:权限（针对默认权限mask） 的方式进行设置，设置成功后该目录文件权限部分会多出一个+</code></li></ul></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master /]# setfacl -m u:jason:rx /root
[root@master /]# ll -d root
dr-xr-x---+ 11 root root 4096 9月  19 17:19 root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>[jason@master ~]$ cd /root
[jason@master root]$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master /]# setfacl -x u:jason /root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="getfacl">getfacl</h3> <ul><li>getfacl filename</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master /]# getfacl root
# file: root
# owner: root
# group: root
user::r-x
user:jason:r-x  &lt;=对于用户jason设置了rx权限
group::r-x
mask::r-x       &lt;=有效权限，设置的user/group acl生效权限是 设置的acl权限与该mask权限的交集，即：set的acl权限比如为rx，但是mask权限只有r，那么acl真实权限只有r
other::---

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="用户身份切换">用户身份切换</h2> <h3 id="su">su</h3> <ul><li>su [-lm] [-c 命令] [username]
<ul><li>-: su -代表使用login-shell的变量文件读取方式来登录系统，没有跟上username代表切换位root身份</li> <li>-l: 与-类似，也是login-shell方式登录，但需加username</li> <li>-m: 使用目前的环境设置，而不读取新使用者的配置文件</li> <li>-c: 仅进行一次命令，所以-c后面可以上命令</li> <li>仅用su切换身份，读取变量设置方式位非登录shell的方式，很多变量不会被修改，尤其时PATH</li></ul></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ su - -c &quot;grep 'yu' /etc/shadow&quot;
密码：
yu:$6$H...:18222:0:99999:7:::
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="sudo">sudo</h3> <blockquote><p>su切换到root用户需要输入root的密码，而sudo切换至root用户则只需要输入自己的密码，
所以并非所有人皆可执行sudo命令，
而是仅有规范到/etc/sudoers内的用户才能够执行sudo命令。</p></blockquote> <ul><li>sudo [-u 新使用者账号]
<ul><li>-u: 后面接欲切换的使用者，无此项则位切换至root</li></ul></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@104 tmp]# sudo -u sshd sh -c &quot;touch a;ls -l&quot;
总用量 0
-rw-r--r--. 1 sshd sshd  0 11月 23 18:03 a
# sh -c &quot;一串命令&quot;
[root@104 tmp]# grep 'sshd' /etc/passwd
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
# sshd位系统用户，其shell是nologin，可利用sudo -u 来执行命令
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>visudo</li></ul> <blockquote><p>若想要使用sudo执行属于root用户的权限命令，则root需要先使用visudo去修改/etc/sudoers，让该账号能够使用全部或部分的root命令功能。
why need visudo? 因为/etc/sudoers是设置过语法的，如果设置错误就会造成无法使用sudo命令的后果，使用visudo去修改，在结束退出修改界面，操作系统
会去检验/etc/sudoers语法的正确性。</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@104 ~]# egrep -v &quot;^[#D]|^$&quot; /etc/sudoers
# 使用者账号 登陆者的来源主机名称=(可切换的身份) 可执行的命令（需使用绝对路径）
root	ALL=(ALL) 	ALL
# 用户组
%wheel	ALL=(ALL)	ALL
[root@104 ~]# visudo
# 有限制地赋予权限，否则把root用户的密码都给修改了
yu ALL=(root) !/usr/bin/passwd,!/usr/bin/passwd root,/usr/bin/passwd [A-Za-z]*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>通过别名创建visudo</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@104 ~]# visudo

User_Alias US=zs,ls,ww
Cmnd_Alias CS=!/usr/bin/passwd,!/usr/bin/passwd root,/usr/bin/passwd [A-Za-z]*
US ALL=(root) CS
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>通过User_Alias建立一个新账号，账号名称需要大写，指向所有的用户名，Cmnd_Alias定义命令变量，Host_Alias定义来源主机</p> <p><code>sudo身份确认时间间隔为5分钟</code><br> <code>sudo搭配su</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@104 ~]# visudo

jason ALL=(root) /bin/su -
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>[jason@104 ~]$ sudo su -
[sudo] jason 的密码：
上一次登录：六 11月 23 21:05:56 CST 2019从 192.168.125.1pts/2 上
[root@104 ~]# 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="sbin-nologin">/sbin/nologin</h2> <ul><li>shell是/sbin/nologin的系统账号，无法使用bash或其他shell来登录系统的，但是可以使用其他系统资源。</li> <li>如果想要在登录系统账户时给予无法登录的原因提示，可修改/etc/nologin.txt该文件</li></ul> <h2 id="用户信息传递">用户信息传递</h2> <h3 id="查询用户">查询用户</h3> <ul><li>w</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ w
 22:35:40 up 6 min,  3 users,  load average: 0.01, 0.11, 0.08
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     tty1                      22:33    2:36   0.02s  0.02s -bash
yu       pts/0    192.168.125.1    22:30    4.00s  0.08s  0.02s w
yu       pts/1    192.168.125.1    22:35    5.00s  0.02s  0.02s -bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>who</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ who
root     tty1         2019-11-23 22:33
yu       pts/0        2019-11-23 22:30 (192.168.125.1)
yu       pts/1        2019-11-23 22:35 (192.168.125.1)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>lastlog: 可查看每个账号最近登录的时间，lastlog会读取/var/log/lastlog文件</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ lastlog | grep -v &quot;从未登录过&quot;
用户名           端口     来自             最后登陆时间
root             tty1                      六 11月 23 22:33:06 +0800 2019
jason            pts/5    192.168.125.1    六 11月 23 22:04:16 +0800 2019
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="用户对话">用户对话</h3> <ul><li>write user [user所在终端界面]<br>
该操作会立刻中断user原本的任务，那如果user不想接受任何信息，user可使用mesg n来设置</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ mesg n
[yu@104 ~]$ mesg
is n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>but,对于root用户传来的信息是无法阻止的。</p> <ul><li>wall &quot;...&quot;<br>
write是针对某一个用户发送消息，而wall则是广播于所有系统在线用户</li></ul> <h3 id="用户邮箱">用户邮箱</h3> <ul><li>安装：yum install -y email</li> <li>mail -s &quot;邮件标题&quot; username[@localhost]</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>[yu@104 ~]$ mail -s &quot;hello&quot; jason
how are you
.  #用.来结束
EOT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>也可以用mail -s &quot;标题&quot; &lt; filename来传输文件内容</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hellof/linux/shell.html" class="prev">
        SHELL
      </a></span> <span class="next"><a href="/hellof/linux/crontab.html">
        计划任务
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hellof/assets/js/app.22404478.js" defer></script><script src="/hellof/assets/js/2.488c7013.js" defer></script><script src="/hellof/assets/js/42.34c364c8.js" defer></script>
  </body>
</html>
